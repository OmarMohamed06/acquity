# Listing Detail Page - Visual Architecture

## Component Hierarchy

```
[slug]/page.tsx (Client Component)
â”‚
â”œâ”€â”€ State Management
â”‚   â”œâ”€â”€ listing (ListingDetail | null)
â”‚   â”œâ”€â”€ loading (boolean)
â”‚   â”œâ”€â”€ error (string | null)
â”‚   â””â”€â”€ showContactModal (boolean)
â”‚
â”œâ”€â”€ Effects
â”‚   â””â”€â”€ useEffect on mount
â”‚       â””â”€â”€ fetchListing()
â”‚           â”œâ”€â”€ Query: listings by slug
â”‚           â”œâ”€â”€ Query: listing_operational
â”‚           â””â”€â”€ Query: listing_financials
â”‚
â”œâ”€â”€ Render: Loading State
â”‚   â””â”€â”€ Animated skeleton
â”‚
â”œâ”€â”€ Render: Error State
â”‚   â””â”€â”€ Error message + Back link
â”‚
â””â”€â”€ Render: Main Content
    â”œâ”€â”€ Breadcrumbs
    â”‚   â”œâ”€â”€ Link to "/"
    â”‚   â”œâ”€â”€ Link to "/businesses-for-sale"
    â”‚   â”œâ”€â”€ Link to filtered category
    â”‚   â””â”€â”€ Current page (text)
    â”‚
    â”œâ”€â”€ Main Grid (3 cols: 2 + 1 sidebar)
    â”‚
    â”œâ”€â”€ Content Section (col-span-2)
    â”‚   â”œâ”€â”€ Header Section
    â”‚   â”‚   â”œâ”€â”€ h1: Title
    â”‚   â”‚   â”œâ”€â”€ Location badge
    â”‚   â”‚   â””â”€â”€ Category tag
    â”‚   â”‚
    â”‚   â”œâ”€â”€ Image Section (420px height)
    â”‚   â”‚   â””â”€â”€ <img> with fallback
    â”‚   â”‚
    â”‚   â”œâ”€â”€ Description Section (Card)
    â”‚   â”‚   â”œâ”€â”€ h2: "Business Description"
    â”‚   â”‚   â””â”€â”€ Multi-paragraph text
    â”‚   â”‚
    â”‚   â”œâ”€â”€ Value Proposition (Card, conditional)
    â”‚   â”‚   â”œâ”€â”€ Icon + Label + Value pairs
    â”‚   â”‚   â”œâ”€â”€ Reason for Sale
    â”‚   â”‚   â””â”€â”€ Owner Involvement
    â”‚   â”‚
    â”‚   â””â”€â”€ Operational Details (Card, conditional)
    â”‚       â”œâ”€â”€ Year Established
    â”‚       â””â”€â”€ Number of Employees
    â”‚
    â””â”€â”€ Sidebar Section (col-span-1)
        â”œâ”€â”€ Financial Summary Card
        â”‚   â”œâ”€â”€ 2x2 Grid of metrics
        â”‚   â”œâ”€â”€ Asking Price
        â”‚   â”œâ”€â”€ Revenue
        â”‚   â”œâ”€â”€ EBITDA
        â”‚   â”œâ”€â”€ Cash Flow
        â”‚   â””â”€â”€ Button: Contact Seller
        â”‚
        â”œâ”€â”€ Serious Buyers Notice Card
        â”‚   â”œâ”€â”€ Info icon
        â”‚   â”œâ”€â”€ Title: "SERIOUS BUYERS"
        â”‚   â””â”€â”€ Description text
        â”‚
        â””â”€â”€ Market Info Card
            â”œâ”€â”€ Chart icon
            â”œâ”€â”€ Title: "MARKET"
            â””â”€â”€ Description text
```

---

## Data Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Browser (React Component)                â”‚
â”‚                                                    â”‚
â”‚  const params = useParams()                       â”‚
â”‚  const slug = params.slug                         â”‚
â”‚                                                    â”‚
â”‚  useEffect(() => {                                â”‚
â”‚    if (!slug) return                              â”‚
â”‚    fetchListing(slug)                             â”‚
â”‚  })                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Supabase Client (JS SDK)   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â†“         â†“         â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚Query 1â”‚ â”‚   Query 2    â”‚ â”‚   Query 3    â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚SELECT â”‚ â”‚SELECT        â”‚ â”‚SELECT        â”‚
        â”‚  *    â”‚ â”‚  *           â”‚ â”‚  *           â”‚
        â”‚FROM   â”‚ â”‚FROM listing_ â”‚ â”‚FROM listing_ â”‚
        â”‚lists  â”‚ â”‚operational  â”‚ â”‚financials   â”‚
        â”‚WHERE  â”‚ â”‚WHERE listing â”‚ â”‚WHERE listing â”‚
        â”‚slug=? â”‚ â”‚_id = ?       â”‚ â”‚_id = ?       â”‚
        â”‚AND    â”‚ â”‚              â”‚ â”‚              â”‚
        â”‚stat=  â”‚ â”‚              â”‚ â”‚              â”‚
        â”‚'appr' â”‚ â”‚              â”‚ â”‚              â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚         â”‚         â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Supabase (PostgreSQL)       â”‚
        â”‚                               â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
        â”‚  â”‚  listings table      â”‚   â”‚
        â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
        â”‚  â”‚ id (PK)              â”‚   â”‚
        â”‚  â”‚ slug (unique)        â”‚   â”‚
        â”‚  â”‚ title                â”‚   â”‚
        â”‚  â”‚ description          â”‚   â”‚
        â”‚  â”‚ price, revenue, ...  â”‚   â”‚
        â”‚  â”‚ image_url            â”‚   â”‚
        â”‚  â”‚ status               â”‚   â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
        â”‚                               â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
        â”‚  â”‚listing_operational   â”‚   â”‚
        â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
        â”‚  â”‚listing_id (FK)       â”‚   â”‚
        â”‚  â”‚employees_count       â”‚   â”‚
        â”‚  â”‚owner_involvement     â”‚   â”‚
        â”‚  â”‚reason_for_sale       â”‚   â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
        â”‚                               â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
        â”‚  â”‚listing_financials    â”‚   â”‚
        â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
        â”‚  â”‚listing_id (FK)       â”‚   â”‚
        â”‚  â”‚valuation_multiple    â”‚   â”‚
        â”‚  â”‚gross_margin          â”‚   â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â†“         â†“         â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚Listing â”‚ â”‚Operationalâ”‚Financialsâ”‚
        â”‚Data    â”‚ â”‚Data      â”‚Data      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  setState(listing, ...)      â”‚
        â”‚  Component Re-renders        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   UI Rendering              â”‚
        â”‚                               â”‚
        â”‚  Sections rendered:          â”‚
        â”‚  âœ“ Breadcrumbs              â”‚
        â”‚  âœ“ Title & location         â”‚
        â”‚  âœ“ Image                    â”‚
        â”‚  âœ“ Description              â”‚
        â”‚  âœ“ Value proposition        â”‚
        â”‚  âœ“ Operational details      â”‚
        â”‚  âœ“ Financial summary        â”‚
        â”‚  âœ“ Contact button           â”‚
        â”‚  âœ“ Sidebar cards            â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## URL Routing

```
Domain
  â””â”€â”€ /businesses-for-sale
        â””â”€â”€ /listing
              â””â”€â”€ /[slug]
                    â”œâ”€â”€ /established-technology-business-for-sale-550e8400
                    â”‚   â””â”€â”€ page.tsx (Component)
                    â”‚
                    â”œâ”€â”€ /premium-coffee-shop-downtown-dubai-550e8400
                    â”‚   â””â”€â”€ page.tsx (Component)
                    â”‚
                    â””â”€â”€ /profitable-retail-business-mall-location-550e8400
                        â””â”€â”€ page.tsx (Component)


Slug Format: {title-words}-{id-first-8-chars}
Example: "established-technology-business-for-sale-550e8400"
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                              title segment                    id segment
```

---

## Database Relations

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       listings (Main)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PK: id (UUID)                                                 â”‚
â”‚ â”œâ”€ slug (unique)                                              â”‚
â”‚ â”œâ”€ title, description, category                               â”‚
â”‚ â”œâ”€ location, country, city                                    â”‚
â”‚ â”œâ”€ type, plan, status                                         â”‚
â”‚ â”œâ”€ established_year                                           â”‚
â”‚ â”œâ”€ price, revenue, ebitda, cash_flow (financial)             â”‚
â”‚ â”œâ”€ image_url, image                                           â”‚
â”‚ â”œâ”€ user_id (FK â†’ auth.users)                                  â”‚
â”‚ â””â”€ created_at, updated_at                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â†“                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚listing_operational   â”‚ â”‚listing_financials    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚PK: listing_id (FK)   â”‚ â”‚PK: listing_id (FK)   â”‚
â”‚â”œâ”€employees_count     â”‚ â”‚â”œâ”€valuation_multiple  â”‚
â”‚â”œâ”€owner_involvement   â”‚ â”‚â”œâ”€gross_margin        â”‚
â”‚â”œâ”€reason_for_sale     â”‚ â”‚â”œâ”€net_margin          â”‚
â”‚â”œâ”€support_provided    â”‚ â”‚â”œâ”€inventory_value     â”‚
â”‚â”œâ”€seller_relationship â”‚ â”‚â”œâ”€assets_value        â”‚
â”‚â””â”€preferred_contact   â”‚ â”‚â”œâ”€liabilities         â”‚
â”‚                      â”‚ â”‚â”œâ”€revenue_3yr_cagr_pctâ”‚
â”‚                      â”‚ â”‚â””â”€income_statement    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Component State Machine

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    INITIAL      â”‚
â”‚  loading: true  â”‚
â”‚  listing: null  â”‚
â”‚  error: null    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ useEffect on mount
         â”‚ if slug exists
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   FETCHING       â”‚
â”‚  loading: true   â”‚
â”‚  listing: null   â”‚
â”‚  error: null     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â†“         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SUCCESS   â”‚  â”‚   ERROR    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚loading:falseâ”‚  â”‚loading:falseâ”‚
â”‚listing: {...} â”‚  â”‚listing: null â”‚
â”‚error: null â”‚  â”‚error: str  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚               â”‚
    â†“               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RENDER    â”‚  â”‚  RENDER    â”‚
â”‚  CONTENT   â”‚  â”‚   ERROR    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Responsive Breakpoints

```
Mobile (< 768px)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Breadcrumbs    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Header         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Image          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Description    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Value Props    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Operational    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Financial Card â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Buyers Notice  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Market Card    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


Tablet (768px - 1024px)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Breadcrumbs            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  â”‚          â”‚
â”‚  Description     â”‚ Financialâ”‚
â”‚                  â”‚          â”‚
â”‚  Value Props     â”‚ Buyers   â”‚
â”‚                  â”‚          â”‚
â”‚  Operational     â”‚ Market   â”‚
â”‚                  â”‚          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


Desktop (> 1024px)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Breadcrumbs                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                         â”‚              â”‚
â”‚    MAIN CONTENT         â”‚    SIDEBAR   â”‚
â”‚    (2/3 width)          â”‚   (1/3 width)â”‚
â”‚                         â”‚              â”‚
â”‚  âœ“ Header              â”‚  âœ“ Financial â”‚
â”‚  âœ“ Image (420px)       â”‚  âœ“ Buyers   â”‚
â”‚  âœ“ Description         â”‚  âœ“ Market    â”‚
â”‚  âœ“ Value Props         â”‚              â”‚
â”‚  âœ“ Operational         â”‚              â”‚
â”‚                         â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Contact Form Modal Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User clicks      â”‚
â”‚ "Contact Seller" â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ showContactModal = true
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ContactModal renders       â”‚
â”‚  â”œâ”€ Name input              â”‚
â”‚  â”œâ”€ Company input           â”‚
â”‚  â”œâ”€ Budget selector         â”‚
â”‚  â”œâ”€ Reason textarea         â”‚
â”‚  â”œâ”€ Email input             â”‚
â”‚  â””â”€ Submit button           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User fills form             â”‚
â”‚ clicks Submit               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Form validation             â”‚
â”‚ â”œâ”€ All required fields?     â”‚
â”‚ â””â”€ Email format valid?      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â†“         â†“
  Valid      Invalid
    â”‚         â””â”€â†’ Show error
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Supabase insert:            â”‚
â”‚ .from("buyer_contact")      â”‚
â”‚ .insert({...})              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â†“         â†“
  Success    Error
    â”‚         â””â”€â†’ Show error message
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Show success message        â”‚
â”‚ "Your inquiry sent!"        â”‚
â”‚ Wait 2 seconds              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Close modal                 â”‚
â”‚ showContactModal = false    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## File Organization

```
acquityapp/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ businesses-for-sale/
â”‚   â”‚   â”œâ”€â”€ listing/
â”‚   â”‚   â”‚   â””â”€â”€ [slug]/
â”‚   â”‚   â”‚       â””â”€â”€ page.tsx âœ¨ (New)
â”‚   â”‚   â””â”€â”€ layout.tsx
â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”œâ”€â”€ layout.tsx
â”‚   â””â”€â”€ page.tsx
â”‚
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ listing-helpers.ts âœ¨ (New)
â”‚   â”œâ”€â”€ formatNumber.ts
â”‚   â”œâ”€â”€ supabase/
â”‚   â”‚   â””â”€â”€ client.ts
â”‚   â””â”€â”€ types.ts
â”‚
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ContactModal.tsx ğŸ“ (Modified)
â”‚   â””â”€â”€ layout/
â”‚
â”œâ”€â”€ db instructions/
â”‚   â”œâ”€â”€ ADD_LISTING_FIELDS_AND_TABLES.sql âœ¨ (New)
â”‚   â”œâ”€â”€ INSERT_SAMPLE_LISTINGS.sql âœ¨ (New)
â”‚   â””â”€â”€ ...existing migrations
â”‚
â”œâ”€â”€ LISTING_DETAIL_COMPLETE.md âœ¨ (New)
â”œâ”€â”€ LISTING_DETAIL_PAGE.md âœ¨ (New)
â”œâ”€â”€ LISTING_DETAIL_IMPLEMENTATION.md âœ¨ (New)
â”œâ”€â”€ LISTING_DETAIL_QUICK_REFERENCE.md âœ¨ (New)
â”œâ”€â”€ DATABASE_SCHEMA.md (Existing)
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ ...other configs
```

---

## Query Performance

```
Parallel Query Execution:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Fetch Listing by slug      â”‚
â”‚  SELECT * FROM listings     â”‚
â”‚  WHERE slug = ? AND ...     â”‚
â”‚  Time: ~50ms                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”
    â†“    â†“    â†“ (Parallel)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Fetch   â”‚  â”‚Fetch       â”‚  â”‚Fetch       â”‚
â”‚Listing â”‚  â”‚Operational â”‚  â”‚Financials  â”‚
â”‚Time:   â”‚  â”‚Time:       â”‚  â”‚Time:       â”‚
â”‚~50ms   â”‚  â”‚~30ms       â”‚  â”‚~30ms       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚         â”‚              â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
    Total time: ~80ms
    (Instead of ~110ms sequential)
```

---

## Error Handling Paths

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Component Mounts            â”‚
â”‚  slug = params.slug          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â†“         â†“
  slug?    no slug
    â”‚         â””â”€â†’ Return (wait for slug)
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Fetch from Supabase         â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“      â†“      â†“
  Network Data DB
  Error    Error  Error
     â”‚      â”‚      â”‚
     â””â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”˜
          â†“
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ error = true â”‚
     â”‚ Show message:â”‚
     â”‚ "Listing not"â”‚
     â”‚ "found"      â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

This provides a complete visual architecture of the system!
